# `vmstat`

- Virtual Memory Statistics
- システム全体のメモリや CPU 使用率の確認
- ボトルネックが IO かメモリか CPU か、という切り分けに役立つ

## 基本コマンド

- `vmstat` で実行

### 出力情報の意味

メモリの単位はキロバイト。

- `procs` 欄
  - `r`: 実行キューに入っているプロセスの数
  - `b`: 処理ブロック中のプロセスの数
    - これが増えるとユーザからは重く感じる
- `memory` 欄
  - `swpd`: スワップ領域の使用量
  - `free`: 未使用メモリ量
  - `buff`: カーネルが使うバッファ領域の量
    - 歴史的にページキャッシュより古い
  - `cache`: キャッシュ領域の使用量
- `swap` 欄
  - `si`: スワップイン量
  - `so`: スワップアウト量
  - 基本は両方 0 が望ましい
- `io` 欄
  - `bi`: ブロックデバイスからの読込量
  - `bo`: ブロックデバイスへの書込量
- `system` 欄
  - `in`: 割り込み処理の回数
  - `cs`: コンテキストスイッチの回数
    - プロセス、スレッドの切り替え。これが増えるとユーザからは重く感じる
- `cpu` 欄
  - `us`: ユーザ処理の利用時間
  - `sy`: カーネル処理の利用時間
  - `wa`: IO 処理の待ち時間
  - `id`: アイドル時間

## オプション

- `sar <オプション> <時間間隔> <表示時間>`
  - `<表示時間>` のあいだ、`<時間間隔>` ごとに表示する
- `-t`
  - 時刻を追加で表示する
