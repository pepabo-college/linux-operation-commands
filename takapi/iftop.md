# iftop コマンドについて(Linux)

## iftopとは
* サーバの通信量が分かるコマンド
  * 何処から何処にどれくらいの通信が発生しているかリアルタイムで表示する
  * 標準では、10秒毎に通信量が多いものをリストとして出している
  * IPとポート番号をベースに、それぞれの通信におけるトラフィック量を表示する
  * 単一のイーサネットのネットワークのみ監視する

## インストール
* epelリポジトリから追加
* `yum install --enablerepo=epel iftop`

## コマンド
* `iftop`
* `iftop -i [インターフェース名]`

## スイッチ
* tスイッチ
  * トラフィックの表示方式の変更（送受信・送信のみ・受信のみなど）
* pスイッチ
  * ポート番号に対応したサービス名が表示される
* 数字スイッチ
  * 並べ替え方法を選択できる

## どんなときに使うか？
* 何処から何処に通信がどれくらい発生しているのかざっくりと知りたいとき

## メリット
* 視覚的に見やすい

## デメリット
* 通信ごとに個別のプロセスを表示させることは出来ない

## 表示されている内容
* TX：送信量
* RX：受信量
* TOTAL：起動後のトラフィック合計
* peak：トラフィックの最大量
* rates：各秒数の平均値。左から2秒、10秒、40秒。

## どの情報見て出力しているのか？
*  `/etc/services`
  * サービス名と番号の変換表が入ったファイル
* libpcap
  * 低レベルのネットワーク監視機能を利用して、ユーザーレベルでのパケットキャプチャー機能を提供するライブラリ

## 実行結果（例）

````

  12.5Kb          25.0Kb          37.5Kb          50.0Kb    62.5Kb
└──────────────┴───────────────┴───────────────┴───────────────┴───────────────
10.0.2.15                 => 10.0.2.3                    584b    584b    783b
             <=                            2.26Kb  2.26Kb  2.73Kb
10.0.2.15                 => 10.0.2.2                   1.72Kb  1.83Kb  1.95Kb
             <=                             640b    810b    784b
10.0.2.15                 => nrt12s02-in-f14.1e100.ne    672b    672b    672b
             <=                             672b    672b    672b
10.0.2.15                 => 163.44.191.106                0b    269b    240b
             <=                               0b    269b    240b










───────────────────────────────────────────────────────────────────────────────
TX:             cum:   6.31KB   peak:   4.81Kb rates:   2.95Kb  3.32Kb  3.61Kb
RX:                    7.67KB           6.52Kb          3.54Kb  3.97Kb  4.38Kb
TOTAL:                 14.0KB           11.3Kb          6.48Kb  7.29Kb  7.99Kb

````
